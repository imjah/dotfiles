#!/bin/bash

init() {
	date=`date +"%Y-%m-%d-%T---"`
	trash_dir="${XDG_DATA_HOME:-$HOME/.local/share}/trash"

	mkdir -p "$trash_dir"
}

main() {
	init
	
	case "$1" in
		-r)
			mv "$trash_dir/${2:-?}" "./${2#*---}"
		;;
		-e)
			rm -rf "$trash_dir" && mkdir -p "$trash_dir"
		;;
		-u)
			du -hs "$trash_dir"
		;;
		-l | "")
			ls -1 "$trash_dir"
		;;
		-h)
			echo "Usage: $(basename $0) [<option>] [file]"
			echo
			echo "Options:"
			echo "  -r  Restore trashed file"
			echo "  -e  Empty trash"
			echo "  -u  Show trash usage"
			echo "  -l  Show trashed files (default)"
			echo "  -h  Show help"
		;;
		*)
			for file in "$@"; do
				mv "$file" "$trash_dir/$date$file"
			done
		;;
	esac
}; main $@
